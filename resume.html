<!DOCTYPE html>
<html lang="en">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resume</title>
    <!-- Import element definition -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-LDPYGH4LDV"></script>
    <script src="js/pdf/pdf.js"></script>
    <script src="js/pdf/pdf.worker.js"></script>
    <!-- <script src="js/pdf/pdf.worker.js"></script> -->
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-LDPYGH4LDV');
    </script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="css/geist-ui.css">
    <link rel="stylesheet" href="css/styles.css">
    <style>
        #annotation-layer { 
            position: absolute;
            left: 0;
            top: 0;
            right: 0;
            bottom: 0;
            overflow: hidden;
            line-height: 1.0;
        }
        
        #annotation-layer > section {
            color: transparent;
            position: absolute;
            white-space: pre;
            cursor: text;
            transform-origin: 0% 0%;
            z-index: 1000;
        }
        
        #annotation-layer > .linkAnnotation > a {
            position: absolute;
            font-size: 1em;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        #annotation-layer > .linkAnnotation > a {
            position: absolute;
            font-size: 1em;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            transition: 0.3s;
            border-bottom: solid 2px #57A6FF;
        }

        #annotation-layer > .linkAnnotation > a:hover {
            opacity: 0.0;
        }

        #pdf-main-container {
            width: 50%;
        }

        #pdf-canvas {
            
        }
    </style>
</head>

<body>
    <div class="container-fluid d-flex flex-column">
        <div class="d-flex justify-content-between pt-5 pb-4">
            <h4 class="smaller">
                <a class="primary" href="index.html">sujaygarlanka</a> <span class="accent">/</span> software-engineer
            </h4>
            <a class="d-lg-none primary" data-bs-toggle="offcanvas" href="#offcanvasExample">
                <i data-feather="menu"></i>
            </a>
            <nav class="nav d-none d-lg-flex">
                <a class="nav-link primary accent" href="resume.html">
                    <h4 class="smaller">Resume</h4>
                </a>
                <a class="nav-link primary" href="experience.html">
                    <h4 class="smaller">Experience</h4>
                </a>
                <a class="nav-link primary" href="projects.html">
                    <h4 class="smaller">Projects</h4>
                </a>
                <a class="nav-link primary" href="https://github.com/sujaygarlanka">
                    <h4 class="smaller">Github</h4>
                </a>
            </nav>
            <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasExample">
                <div class="offcanvas-header">
                    <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas"></button>
                </div>
                <div class="offcanvas-body">
                    <nav class="nav nav-fill flex-column">
                        <a class="nav-link pb-3 primary accent" href="resume.html">
                            <h3><span class="accent"></span> Resume</h3>
                        </a>
                        <a class="nav-link pb-3 primary" href="experience.html">
                            <h3><span class="accent"></span> Experience</h3>
                        </a>
                        <a class="nav-link pb-3 primary" href="projects.html">
                            <h3><span class="accent"></span> Projects</h3>
                        </a>
                        <a class="nav-link pb-3 primary" href="https://github.com/sujaygarlanka">
                            <h3><span class="accent"></span> Github</h3>
                        </a>
                    </nav>
                </div>
            </div>
        </div>
        <div style="margin-right: 3.7%" class="d-flex justify-content-end">
            <a class="pe-4" href="https://raw.githubusercontent.com/sujaygarlanka/resume/main/Sujay%20Garlanka%20Resume.pdf"><i
                    data-feather="download-cloud"></i></a>
            <a href="https://docs.google.com/viewerng/viewer?url=https://raw.githubusercontent.com/sujaygarlanka/resume/main/Sujay+Garlanka+Resume.pdf"><i
                        data-feather="external-link"></i></a>
        </div>
        <div class="d-flex justify-content-center">
            <canvas id="pdf-canvas"></canvas>
            <div id="annotation-layer"></div>
            <!-- <div id="text-layer"></div> -->
        </div>
        <div class="justify-content-end py-5"></div>
    </div>
    <script>
    feather.replace();

    // Store the window width
    var windowWidth = $(window).width();
    $(window).resize(function () {
        // Check window width has actually changed and it's not just iOS triggering a resize event on scroll
        if ($(window).width() != windowWidth) {
            // Update the window width for next time
            windowWidth = $(window).width();
            render();
        }
    });

    var PAGE_1,
	CANVAS = $('#pdf-canvas').get(0),
	CANVAS_CTX = CANVAS.getContext('2d'),
	VIEWPORT;

	PDFJS.getDocument({ url: 'https://raw.githubusercontent.com/sujaygarlanka/resume/main/Sujay%20Garlanka%20Resume.pdf' }).then(function(pdf) {
		return pdf.getPage(1);
	}).then(function(page) {
        PAGE_1 = page;
        render();
    });

    function render() {
        var pageWidth = window.innerWidth * 0.8;

        CANVAS.width = pageWidth;
        var scale_required = CANVAS.width / PAGE_1.getViewport(1).width;
        // Get viewport of the page at required scale
        VIEWPORT = PAGE_1.getViewport(scale_required);

        console.log(CANVAS.width);
        console.log(VIEWPORT.width);

        // Set canvas height
        CANVAS.width = VIEWPORT.width;
        //VIEWPORT.width = CANVAS.width;
        CANVAS.height = VIEWPORT.height;
       // CANVAS.style.width = pageWidth;
       // CANVAS.style.height = "50"


        var renderContext = {
            canvasContext: CANVAS_CTX,
            viewport: VIEWPORT
        };
        
        // Render the page contents in the canvas
        PAGE_1.render(renderContext).then(function() {
            // Return annotation data of the page after the pdf has been rendered in the canvas
            return Promise.all([PAGE_1.getAnnotations(), PAGE_1.getTextContent()])
        }).then(function(data) {
            var annotations = data[0];
            var text = data[1];
            if(annotations.length == 0)
                return;
            
            // Get canvas offset
            var canvas_offset = $("#pdf-canvas").offset();

            $('#annotation-layer').empty();
            // Assign the CSS created to the annotation-layer element
            $("#annotation-layer").css({ left: canvas_offset.left + 'px', top: canvas_offset.top + 'px', height: CANVAS.height + 'px', width: CANVAS.width + 'px' });

            PDFJS.AnnotationLayer.render({
                viewport: VIEWPORT.clone({ dontFlip: true }),
                div: $("#annotation-layer").get(0),
                annotations: annotations,
                page: PAGE_1
            });

            // Assign CSS to the text-layer element
            // $("#text-layer").css({ left: canvas_offset.left + 'px', top: canvas_offset.top + 'px', height: CANVAS.height + 'px', width: CANVAS.width + 'px' });

            // Pass the data to the method for rendering of text over the pdf canvas.
            /* PDFJS.renderTextLayer({
                textContent: text,
                container: $("#text-layer").get(0),
                viewport: VIEWPORT,
                textDivs: []
            }); */
        });
    }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
</body>

</html>